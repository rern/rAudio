!function(t,e,n){"use strict";if(!t.PushStream){var s={},i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=function(t){return(t<10?"0":"")+t};s.dateToUTCString=function(t){var e=r(t.getUTCHours())+":"+r(t.getUTCMinutes())+":"+r(t.getUTCSeconds());return i[t.getUTCDay()]+", "+r(t.getUTCDate())+" "+o[t.getUTCMonth()]+" "+t.getUTCFullYear()+" "+e+" GMT"};var a=function(){for(var t=arguments[0]||{},e=0;e<arguments.length;e++){var n=arguments[e];for(var s in n)n.hasOwnProperty&&!n.hasOwnProperty(s)||(t[s]=n[s])}return t},c=/^[\],:{}\s]*$/,h=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g;s.parseJSON=function(e){if(!e||!y(e))return null;if(e=e.replace(/^\s*/,"").replace(/\s*$/,""),t.JSON&&t.JSON.parse)try{return t.JSON.parse(e)}catch(t){throw"Invalid JSON: "+e}if(c.test(e.replace(h,"@").replace(u,"]").replace(l,"")))return new Function("return "+e)();throw"Invalid JSON: "+e};var m=function(t){var e={};return e[t.tagArgument]="",e[t.timeArgument]="",e[t.eventIdArgument]="",t.messagesControlByArgument&&(e[t.tagArgument]=Number(t._etag),t._lastModified?e[t.timeArgument]=t._lastModified:t._lastEventId&&(e[t.eventIdArgument]=t._lastEventId)),e},d=function(){return(new Date).getTime()},p=function(){return{_:d()}},g=function(t){var e=t;if("object"==typeof t){for(var n in e="",t)t.hasOwnProperty&&!t.hasOwnProperty(n)||(e+="&"+n+"="+C(t[n]));e=e.substring(1)}return e||""},f=function(t,e){return t+(t.indexOf("?")<0?"?":"&")+g(e)},_=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},y=function(t){return"[object String]"===Object.prototype.toString.call(t)},v=function(t){return"[object Date]"===Object.prototype.toString.call(t)},S={logger:null,debug:function(){"debug"===U.LOG_LEVEL&&S._log.apply(S._log,arguments)},info:function(){"info"!==U.LOG_LEVEL&&"debug"!==U.LOG_LEVEL||S._log.apply(S._log,arguments)},error:function(){S._log.apply(S._log,arguments)},_initLogger:function(){var e=t.console;e&&e.log&&(e.log.apply?S.logger=e.log:"object"==typeof e.log&&Function.prototype.bind?S.logger=Function.prototype.bind.call(e.log,e):"object"==typeof e.log&&Function.prototype.call&&(S.logger=function(){Function.prototype.call.call(e.log,e,Array.prototype.slice.call(arguments))}))},_log:function(){if(S.logger||S._initLogger(),S.logger)try{S.logger.apply(t.console,arguments)}catch(e){S._initLogger(),S.logger&&S.logger.apply(t.console,arguments)}var n=e.getElementById(U.LOG_OUTPUT_ELEMENT_ID);if(n){for(var s="",i=0;i<arguments.length;i++)s+=arguments[i]+" ";n.innerHTML+=s+"\n";var o=n.innerHTML.split("\n");o.length>100&&(n.innerHTML=o.slice(-100).join("\n"))}}},b={_getXHRObject:function(e){var n=!1;if(e){try{n=new t.XDomainRequest}catch(t){}if(n)return n}try{n=new t.XMLHttpRequest}catch(e){try{n=new t.ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{n=new t.ActiveXObject("Microsoft.XMLHTTP")}catch(t){n=!1}}}return n},_send:function(e,n){(e=e||{}).timeout=e.timeout||3e4;var s=b._getXHRObject(e.crossDomain);if(s&&e.url){b.clear(e),e.xhr=s,t.XDomainRequest&&s instanceof t.XDomainRequest?(s.onload=function(){e.afterReceive&&e.afterReceive(s),e.success&&e.success(s.responseText)},s.onerror=s.ontimeout=function(){e.afterReceive&&e.afterReceive(s),e.error&&e.error(s.status)}):s.onreadystatechange=function(){4===s.readyState&&(b.clear(e),e.afterReceive&&e.afterReceive(s),200===s.status?e.success&&e.success(s.responseText):e.error&&e.error(s.status))},e.beforeOpen&&e.beforeOpen(s);var i={},o=null,r="GET";n?(o=g(e.data),r="POST"):i=e.data||{},s.open(r,f(e.url,a({},i,p())),!0),e.beforeSend&&e.beforeSend(s);return n?s.setRequestHeader&&(s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")):e.timeoutId=t.setTimeout(function(){b.clear(e);try{s.abort()}catch(t){}e.error(304)},e.timeout+2e3),s.send(o),s}},_clear_xhr:function(t){t&&(t.onreadystatechange=null)},_clear_script:function(t){t&&(t.onerror=t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t))},_clear_timeout:function(t){t.timeoutId=x(t.timeoutId)},_clear_jsonp:function(e){var n=e.data.callback;n&&(t[n]=function(){t[n]=null})},clear:function(t){b._clear_timeout(t),b._clear_jsonp(t),b._clear_script(e.getElementById(t.scriptId)),b._clear_xhr(t.xhr)},jsonp:function(n){n.timeout=n.timeout||3e4,b.clear(n);var s=e.head||e.getElementsByTagName("head")[0],i=e.createElement("script"),o=d(),r=function(){b.clear(n);var t=d();n.error(t-o>n.timeout/2?304:403)};return i.onerror=r,i.onload=i.onreadystatechange=function(){i.readyState&&!/loaded|complete/.test(i.readyState)||(n.afterSuccess?(b.clear(n),n.load()):r())},n.beforeOpen&&n.beforeOpen({}),n.beforeSend&&n.beforeSend({}),n.timeoutId=t.setTimeout(r,n.timeout+2e3),n.scriptId=n.scriptId||d(),n.afterSuccess=null,n.data.callback=n.scriptId+"_onmessage_"+d(),t[n.data.callback]=function(){n.afterSuccess=!0,n.success.apply(null,arguments)},i.setAttribute("src",f(n.url,a({},n.data,p()))),i.setAttribute("async","async"),i.setAttribute("id",n.scriptId),s.insertBefore(i,s.firstChild),n},load:function(t){return b._send(t,!1)},post:function(t){return b._send(t,!0)}},C=function(e){return e?t.encodeURIComponent(e):""},T=function(e){return e?t.decodeURIComponent(e):""};s.parseMessage=function(t,e){var n=t;return y(t)&&(n=s.parseJSON(t)),{id:n[e.jsonIdKey],channel:n[e.jsonChannelKey],text:y(n[e.jsonTextKey])?T(n[e.jsonTextKey]):n[e.jsonTextKey],tag:n[e.jsonTagKey],time:n[e.jsonTimeKey],eventid:n[e.jsonEventIdKey]||""}};var E=function(t,e){var n,s="";for(var i in t)t.hasOwnProperty&&!t.hasOwnProperty(i)||(s+="/"+i+(e?(n=t[i]).backtrack?".b"+Number(n.backtrack):"":""));return s},P=function(t,e,n,s){var i=t.wrapper.type===M.TYPE,o=t.useSSL,r=I(o,t.port),c=i?o?"wss://":"ws://":o?"https://":"http://";c+=t.host,c+=r?":"+r:"",c+=e;var h=E(t.channels,s);if(t.channelsByArgument){var u={};u[t.channelsArgument]=h.substring(1),n=a({},n,u)}else c+=h;return f(c,n)},w=function(t){var e=I(t.useSSL,t.port),n=t.useSSL?"https://":"http://";return n+=t.host,n+=e?":"+e:"",n+=t.urlPrefixPublisher,n+="?id="+E(t.channels,!1)};s.extract_xss_domain=function(t){if(t.match(/^(\d{1,3}\.){3}\d{1,3}$/))return t;var e=t.split("."),n=Math.max(e.length-1,t.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3);return e.slice(-1*n).join(".")};var I=function(t,e){return e=Number(e||(t?443:80)),!t&&80===e||t&&443===e?"":e};s.isCrossDomainUrl=function(n){if(!n)return!1;var s=e.createElement("a");s.href=n;var i=I("https:"===t.location.protocol,t.location.port),o=I("https:"===s.protocol,s.port);return t.location.protocol!==s.protocol||t.location.hostname!==s.hostname||i!==o};var O=function(t,e){return function(){return t.apply(e,arguments)}},x=function(e){return e&&t.clearTimeout(e),null},L=function(t){S.info("["+this.type+"] message received",arguments);var e=s.parseMessage(t.data,this.pushstream);e.tag&&(this.pushstream._etag=e.tag),e.time&&(this.pushstream._lastModified=e.time),e.eventid&&(this.pushstream._lastEventId=e.eventid),this.pushstream._onmessage(e.text,e.id,e.channel,e.eventid,!0,e.time)},A=function(){this.pushstream._onopen(),S.info("["+this.type+"] connection opened")},N=function(e){S.info("["+this.type+"] error (disconnected by server):",e),this.pushstream.readyState===U.OPEN&&this.type===j.TYPE&&"error"===e.type&&this.connection.readyState===t.EventSource.CONNECTING||(this._closeCurrentConnection(),this.pushstream._onerror({type:e&&("load"===e.type||"close"===e.type&&1006===e.code)||this.pushstream.readyState===U.CONNECTING?"load":"timeout"}))},M=function(e){if(!t.WebSocket&&!t.MozWebSocket)throw"WebSocket not supported";this.type=M.TYPE,this.pushstream=e,this.connection=null};M.TYPE="WebSocket",M.prototype={connect:function(){this._closeCurrentConnection();var e=a({},this.pushstream.extraParams(),p(),m(this.pushstream)),n=P(this.pushstream,this.pushstream.urlPrefixWebsocket,e,!this.pushstream._useControlArguments());this.connection=t.WebSocket?new t.WebSocket(n):new t.MozWebSocket(n),this.connection.onerror=O(N,this),this.connection.onclose=O(N,this),this.connection.onopen=O(A,this),this.connection.onmessage=O(L,this),S.info("[WebSocket] connecting to:",n)},disconnect:function(){this.connection&&(S.debug("[WebSocket] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}},sendMessage:function(t){this.connection&&this.connection.send(t)}};var j=function(e){if(!t.EventSource)throw"EventSource not supported";this.type=j.TYPE,this.pushstream=e,this.connection=null};j.TYPE="EventSource",j.prototype={connect:function(){this._closeCurrentConnection();var e=a({},this.pushstream.extraParams(),p(),m(this.pushstream)),n=P(this.pushstream,this.pushstream.urlPrefixEventsource,e,!this.pushstream._useControlArguments());this.connection=new t.EventSource(n),this.connection.onerror=O(N,this),this.connection.onopen=O(A,this),this.connection.onmessage=O(L,this),S.info("[EventSource] connecting to:",n)},disconnect:function(){this.connection&&(S.debug("[EventSource] closing connection to:",this.connection.url),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(t){}this.connection=null}}};var k=function(t){this.type=k.TYPE,this.pushstream=t,this.connection=null,this.url=null,this.frameloadtimer=null,this.pingtimer=null,this.iframeId="PushStreamManager_"+t.id};k.TYPE="Stream",k.prototype={connect:function(){this._closeCurrentConnection();var t=s.extract_xss_domain(this.pushstream.host);try{e.domain=t}catch(e){S.error("[Stream] (warning) problem setting document.domain = "+t+" (OBS: IE8 does not support set IP numbers as domain)")}var n=a({},this.pushstream.extraParams(),p(),{streamid:this.pushstream.id},m(this.pushstream));this.url=P(this.pushstream,this.pushstream.urlPrefixStream,n,!this.pushstream._useControlArguments()),S.debug("[Stream] connecting to:",this.url),this.loadFrame(this.url)},disconnect:function(){this.connection&&(S.debug("[Stream] closing connection to:",this.url),this._closeCurrentConnection(),this.pushstream._onclose())},_clear_iframe:function(){var t=e.getElementById(this.iframeId);t&&(t.onload=null,t.src="about:blank",t.parentNode&&t.parentNode.removeChild(t))},_closeCurrentConnection:function(){this._clear_iframe(),this.connection&&(this.pingtimer=x(this.pingtimer),this.frameloadtimer=x(this.frameloadtimer),this.connection=null,this.transferDoc=null,"function"==typeof t.CollectGarbage&&t.CollectGarbage())},loadFrame:function(n){this._clear_iframe();var s=null;if("ActiveXObject"in t){var i=new t.ActiveXObject("htmlfile");i.open(),i.write("<html><script>document.domain='"+e.domain+"';<\/script>"),i.write("<body><iframe id='"+this.iframeId+"' src='"+n+"'></iframe></body></html>"),i.parentWindow.PushStream=U,i.close(),s=i.getElementById(this.iframeId),this.transferDoc=i}else(s=e.createElement("IFRAME")).style.width="1px",s.style.height="1px",s.style.border="none",s.style.position="absolute",s.style.top="-10px",s.style.marginTop="-10px",s.style.zIndex="-20",s.PushStream=U,e.body.appendChild(s),s.setAttribute("src",n),s.setAttribute("id",this.iframeId);s.onload=O(N,this),this.connection=s,this.frameloadtimer=t.setTimeout(O(N,this),this.pushstream.timeout)},register:function(t){this.frameloadtimer=x(this.frameloadtimer),t.p=O(this.process,this),this.connection.onload=O(this._onframeloaded,this),this.pushstream._onopen(),this.setPingTimer(),S.info("[Stream] frame registered")},process:function(t,e,n,s,i,o){this.pingtimer=x(this.pingtimer),S.info("[Stream] message received",arguments),-1!==t&&(o&&(this.pushstream._etag=o),i&&(this.pushstream._lastModified=i),s&&(this.pushstream._lastEventId=s)),this.pushstream._onmessage(T(n),t,e,s||"",!0,i),this.setPingTimer()},_onframeloaded:function(){S.info("[Stream] frame loaded (disconnected by server)"),this.pushstream._onerror({type:"timeout"}),this.connection.onload=null,this.disconnect()},setPingTimer:function(){this.pingtimer&&x(this.pingtimer),this.pingtimer=t.setTimeout(O(N,this),this.pushstream.pingtimeout)}};var R=function(t){this.type=R.TYPE,this.pushstream=t,this.connection=null,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=O(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.timeout,data:{},url:null,success:O(this.onmessage,this),error:O(this.onerror,this),load:O(this.onload,this),beforeSend:O(this.beforeSend,this),afterReceive:O(this.afterReceive,this)}};R.TYPE="LongPolling",R.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.urlWithBacktrack=P(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!0),this.urlWithoutBacktrack=P(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!1),this.xhrSettings.url=this.urlWithBacktrack,this.useJSONP=this.pushstream._crossDomain||this.pushstream.useJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.messagesControlByArgument=!0),this._listen(),this.opentimer=t.setTimeout(O(A,this),150),S.info("[LongPolling] connecting to:",this.xhrSettings.url)},_listen:function(){this._internalListenTimeout&&x(this._internalListenTimeout),this._internalListenTimeout=t.setTimeout(this._linkedInternalListen,100)},_internalListen:function(){this.pushstream._keepConnected&&(this.xhrSettings.url=this.pushstream._useControlArguments()?this.urlWithoutBacktrack:this.urlWithBacktrack,this.xhrSettings.data=a({},this.pushstream.extraParams(),this.xhrSettings.data,m(this.pushstream)),this.useJSONP?this.connection=b.jsonp(this.xhrSettings):this.connection||(this.connection=b.load(this.xhrSettings)))},disconnect:function(){this.connection&&(S.debug("[LongPolling] closing connection to:",this.xhrSettings.url),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=x(this.opentimer),this.connection){try{this.connection.abort()}catch(t){try{b.clear(this.connection)}catch(t){}}this.connection=null,this.xhrSettings.url=null}},beforeSend:function(t){this.pushstream.messagesControlByArgument||(t.setRequestHeader("If-None-Match",this.pushstream._etag),t.setRequestHeader("If-Modified-Since",this.pushstream._lastModified))},afterReceive:function(t){this.pushstream.messagesControlByArgument||(this.pushstream._etag=t.getResponseHeader("Etag"),this.pushstream._lastModified=t.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(t){this._closeCurrentConnection(),this.pushstream._keepConnected&&(304===t?this._listen():(S.info("[LongPolling] error (disconnected by server):",t),this.pushstream._onerror({type:403===t||this.pushstream.readyState===U.CONNECTING?"load":"timeout"})))},onload:function(){this._listen()},onmessage:function(t){this._internalListenTimeout&&x(this._internalListenTimeout),S.info("[LongPolling] message received",t);for(var e=null,n=_(t)?t:t.replace(/\}\{/g,"}\r\n{").split("\r\n"),i=0;i<n.length;i++)n[i]&&(e=s.parseMessage(n[i],this.pushstream),this.messagesQueue.push(e),this.pushstream.messagesControlByArgument&&e.time&&(this.pushstream._etag=e.tag,this.pushstream._lastModified=e.time));for(this._listen();this.messagesQueue.length>0;){var o=this.messagesQueue.shift();this.pushstream._onmessage(o.text,o.id,o.channel,o.eventid,0===this.messagesQueue.length,o.time)}}};var D=[],U=function(e){e=e||{},this.id=D.push(this)-1,this.useSSL=e.useSSL||!1,this.host=e.host||t.location.hostname,this.port=Number(e.port||(this.useSSL?443:80)),this.timeout=e.timeout||3e4,this.pingtimeout=e.pingtimeout||3e4,this.reconnectOnTimeoutInterval=e.reconnectOnTimeoutInterval||3e3,this.reconnectOnChannelUnavailableInterval=e.reconnectOnChannelUnavailableInterval||6e4,this.autoReconnect=!1!==e.autoReconnect,this.lastEventId=e.lastEventId||null,this.messagesPublishedAfter=e.messagesPublishedAfter,this.messagesControlByArgument=e.messagesControlByArgument||!1,this.tagArgument=e.tagArgument||"tag",this.timeArgument=e.timeArgument||"time",this.eventIdArgument=e.eventIdArgument||"eventid",this.useJSONP=e.useJSONP||!1,this._reconnecttimer=null,this._etag=0,this._lastModified=null,this._lastEventId=null,this.urlPrefixPublisher=e.urlPrefixPublisher||"/pub",this.urlPrefixStream=e.urlPrefixStream||"/sub",this.urlPrefixEventsource=e.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=e.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=e.urlPrefixWebsocket||"/ws",this.jsonIdKey=e.jsonIdKey||"id",this.jsonChannelKey=e.jsonChannelKey||"channel",this.jsonTextKey=e.jsonTextKey||"text",this.jsonTagKey=e.jsonTagKey||"tag",this.jsonTimeKey=e.jsonTimeKey||"time",this.jsonEventIdKey=e.jsonEventIdKey||"eventid",this.modes=(e.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onchanneldeleted=e.onchanneldeleted||null,this.onmessage=e.onmessage||null,this.onerror=e.onerror||null,this.onstatuschange=e.onstatuschange||null,this.extraParams=e.extraParams||function(){return{}},this.channels={},this.channelsCount=0,this.channelsByArgument=e.channelsByArgument||!1,this.channelsArgument=e.channelsArgument||"channels",this._crossDomain=s.isCrossDomainUrl(w(this));for(var n=0;n<this.modes.length;n++)try{var i=null;switch(this.modes[n]){case"websocket":i=new M(this);break;case"eventsource":i=new j(this);break;case"longpolling":i=new R(this);break;case"stream":i=new k(this)}this.wrappers[this.wrappers.length]=i}catch(t){S.info(t)}this.readyState=0};U.LOG_LEVEL="error",U.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",U.CLOSED=0,U.CONNECTING=1,U.OPEN=2,U.prototype={addChannel:function(t,e){if(C(t)!==t)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if(S.debug("entering addChannel"),void 0!==this.channels[t])throw"Cannot add channel "+t+": already subscribed";e=e||{},S.info("adding channel",t,e),this.channels[t]=e,this.channelsCount++,this.readyState!==U.CLOSED&&this.connect(),S.debug("leaving addChannel")},removeChannel:function(t){this.channels[t]&&(S.info("removing channel",t),delete this.channels[t],this.channelsCount--)},removeAllChannels:function(){S.info("removing all channels"),this.channels={},this.channelsCount=0},_setState:function(t){this.readyState!==t&&(S.info("status changed",t),this.readyState=t,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){if(S.debug("entering connect"),!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";this._keepConnected=!0,this._lastUsedMode=0,this._connect(),S.debug("leaving connect")},disconnect:function(){S.debug("entering disconnect"),this._keepConnected=!1,this._disconnect(),this._setState(U.CLOSED),S.info("disconnected"),S.debug("leaving disconnect")},_useControlArguments:function(){return this.messagesControlByArgument&&(null!==this._lastModified||null!==this._lastEventId)},_connect:function(){if(null===this._lastEventId&&(this._lastEventId=this.lastEventId),null===this._lastModified){var t=this.messagesPublishedAfter;if(!v(t)){var e=Number(this.messagesPublishedAfter);e>0?(t=new Date).setTime(t.getTime()-1e3*e):e<0&&(t=new Date(0))}v(t)&&(this._lastModified=s.dateToUTCString(t))}this._disconnect(),this._setState(U.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(t){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this._reconnecttimer=x(this._reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this._reconnecttimer=x(this._reconnecttimer),this._setState(U.OPEN),this._lastUsedMode>0&&this._lastUsedMode--},_onclose:function(){this._reconnecttimer=x(this._reconnecttimer),this._setState(U.CLOSED),this._reconnect(this.reconnectOnTimeoutInterval)},_onmessage:function(t,e,n,s,i,o){S.debug("message",t,e,n,s,i,o),-2===e?this.onchanneldeleted&&this.onchanneldeleted(n):e>0&&this.onmessage&&this.onmessage(t,e,n,s,i,o)},_onerror:function(t){this._setState(U.CLOSED),this._reconnect("timeout"===t.type?this.reconnectOnTimeoutInterval:this.reconnectOnChannelUnavailableInterval),this.onerror&&this.onerror(t)},_reconnect:function(e){this.autoReconnect&&this._keepConnected&&!this._reconnecttimer&&this.readyState!==U.CONNECTING&&(S.info("trying to reconnect in",e),this._reconnecttimer=t.setTimeout(O(this._connect,this),e))},sendMessage:function(t,e,n){t=C(t),this.wrapper.type===M.TYPE?(this.wrapper.sendMessage(t),e&&e()):b.post({url:w(this),data:t,success:e,error:n,crossDomain:this._crossDomain})}},U.sendMessage=function(t,e,n,s){b.post({url:t,data:C(e),success:n,error:s})},U.register=function(t){var e=t.window.location.href.match(/streamid=([0-9]*)&?/);e[1]&&D[e[1]]&&D[e[1]].wrapper.register(t)},U.unload=function(){for(var t=0;t<D.length;t++)try{D[t].disconnect()}catch(t){}},t.PushStream=U,t.PushStreamManager=D,t.jasmine&&(t.Utils=s),t.attachEvent&&t.attachEvent("onunload",U.unload),t.addEventListener&&t.addEventListener.call(t,"unload",U.unload,!1)}}(window,document);
